{% extends 'layout.html' %}
{% block title %}Dashboard{% endblock %}
{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='dashboard.css') }}">
{% endblock %}
{% block content %}
<div class="dashboard">
    <section class="dashboard__hero">
        <div class="dashboard__welcome">
            <h2>Welcome back, {{ display_name }}!</h2>
            <p class="dashboard__tagline">Manage your Stockton University esports events, teams, and updates in one place.</p>
            <div class="dashboard__cta-group">
                <a class="btn btn--primary" href="{{ url_for('eventRegister') }}">Create New Event</a>
                <a class="btn" href="{{ url_for('calendar') }}">View Calendar</a>
            </div>
        </div>
        <div class="dashboard__stats">
            <div class="stat">
                <span class="stat__label">Upcoming Events</span>
                <span class="stat__value">{{ events_count }}</span>
            </div>
            <div class="stat">
                <span class="stat__label">Verified Account</span>
                <span class="stat__value">{% if is_verified %}Yes{% else %}No{% endif %}</span>
            </div>
        </div>
    </section>

    <section class="dashboard__content">
        <div class="dashboard__column">
            <div class="panel">
                <div class="panel__header">
                    <h3>Upcoming Events</h3>
                    <a href="{{ url_for('calendar') }}" class="panel__link">Open calendar</a>
                </div>
                {% if events %}
                <ul class="event-list">
                    {% for event in events %}
                    <li class="event-list__item">
                        <div class="event-list__date">
                            <span class="event-list__day">{{ event.day or event.raw_date_label or '—' }}</span>
                            <span class="event-list__month">{{ event.month }}</span>
                        </div>
                        <div class="event-list__details">
                            <h4>{{ event.name }}</h4>
                            <p>
                                {{ event.time or 'TBD' }}
                                {% if event.description %} · {{ event.description }}{% endif %}
                                {% if not event.day and event.raw_date_label %} · {{ event.raw_date_label }}{% endif %}
                            </p>
                        </div>
                    </li>
                    {% endfor %}
                </ul>
                {% else %}
                <p class="empty-state">No upcoming events have been scheduled yet. Use the Create New Event button to get started.</p>
                {% endif %}
            </div>

            <div class="panel">
                <div class="panel__header">
                    <h3>Latest Announcements</h3>
                </div>
                <ul class="announcement-list">
                    <li class="announcement-list__item">
                        <h4>Need the new design assets?</h4>
                        <p>Download the Figma export and drop the static assets into <code>EsportsManagementTool/EsportsManagementTool/static</code> to see the final visuals.</p>
                    </li>
                    <li class="announcement-list__item">
                        <h4>Onboarding Reminder</h4>
                        <p>Ensure new esports members verify their Stockton email before their first practice.</p>
                    </li>
                </ul>
            </div>
        </div>

        <div class="dashboard__column dashboard__column--secondary">
            <div class="panel">
                <div class="panel__header">
                    <h3>Your Profile</h3>
                    <a href="{{ url_for('profile') }}" class="panel__link">View details</a>
                </div>
                {% if user %}
                <dl class="profile-summary">
                    <div>
                        <dt>Username</dt>
                        <dd>{{ user.username }}</dd>
                    </div>
                    <div>
                        <dt>Email</dt>
                        <dd>{{ user.email }}</dd>
                    </div>
                    <div>
                        <dt>Member Since</dt>
                        <dd>{{ member_since or '—' }}</dd>
                    </div>
                </dl>
                {% else %}
                <p class="empty-state">We couldn't load your account details. Try reloading the page.</p>
                {% endif %}
            </div>

            <div class="panel panel--accent">
                <h3>Need help with the design integration?</h3>
                <p>Once the Figma assets are available locally, replace the placeholder styles in <code>dashboard.css</code> with the exported CSS to achieve a pixel-perfect match.</p>
                <a class="btn btn--inverted" href="https://www.figma.com/" target="_blank" rel="noopener">Open Figma</a>
            </div>
        </div>
    </section>
</div>
{% endblock %}
